{% load custom_templates %}
{% load custom_filters %}  <!-- Ensure your custom template tags are loaded -->

<body>
  <div class="overflow-x-auto">
    <div id="overtime-dialog" class="hidden fixed inset-0 items-center flex justify-center bg-black bg-opacity-50 z-50">
      <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 max-w-lg">
          <h2 class="text-xl mb-4">Unesite prekovremene sate</h2>
          
          <label for="overtime-hours">Prekovremeni sati</label>
          <input type="number" id="overtime-hours" class="border p-2 mb-4 w-full" value="">
          
          <label for="day-hours">Dnevni sati</label>
          <input type="number" id="day-hours" class="border p-2 mb-4 w-full" value="">
          
          <label for="night-hours">NoÄ‡ni sati</label>
          <input type="number" id="night-hours" class="border p-2 mb-4 w-full" value="">
          
          <input type="hidden" id="employee-id">
          <input type="hidden" id="work-date">
          <input type="hidden" id="shift-type-id">
          
          <button onclick="submitOvertime()" class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded">U redu</button>
          <button onclick="closeOvertimeDialog()" class="bg-red-500 hover:bg-red-700 text-white py-2 px-4 rounded ml-2">Odustani</button>
      </div>
  </div>
    <table class="min-w-full leading-normal table-fixed schedule-table">
        <thead class="bg-gray-100">
        <tr>
            <th class="px-4 py-2 border max-w-10">Datum</th>
            {% with modified_shift_types=shift_types|move_shifts_to_end:"JANAF 2.Smjena,JANAF 1.smjena,INA 2.Smjena,INA 1.smjena" %}
              {% for shift_type in modified_shift_types %}
              <th class="px-4 py-2 border">{{ shift_type.name }}</th>
              {% endfor %}
            {% endwith %}
        </tr>
        </thead>
        <tbody>
          {% for day in week_dates %}
            <tr class="hover:bg-gray-50">
              <td class="px-4 py-2 border">{{ day|date:"D" | translate_day }} {{ day|date:"d.m.Y" }}</td>
              {% with modified_shift_types=shift_types|move_shifts_to_end:"JANAF 2.Smjena,JANAF 1.smjena,INA 2.Smjena,INA 1.smjena" %}
                {% for shift_type in modified_shift_types %}
                <td class="px-4 py-2 border">
                  <div class="dropzone" data-shift-type-id="{{ shift_type.id }}" data-date="{{ day|date:'Y-m-d' }}">
                    {% with day_str=day|date:"Y-m-d" %}
                      {% with schedule_entry=schedule_data|get_item:day_str|get_item:shift_type.id %}
                        {% if schedule_entry %}
                          {% for employee in schedule_entry.employees.all %}
                          <div class="employee-block group-{{ employee.group }}" id="employee-block-{{ employee.id }}-{{ day|date:'Y-m-d' }}-{{ shift_type.id }}" data-employee-id="{{ employee.id }}" data-group="{{ employee.group }}"  data-shift-type-id="{{ shift_type.id }}">
                              <span class="employee-name">{{ employee.name }} {{ employee.surname }}</span>
                          </div>
                          {% endfor %}
                        {% endif %}
                      {% endwith %}
                    {% endwith %}
                  </div>
                </td>
                {% endfor %}
              {% endwith %}
            </tr>
          {% endfor %}
        </tbody>
    </table>
</div>
</body>